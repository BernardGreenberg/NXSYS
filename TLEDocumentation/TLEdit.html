<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body style="max-width:800px">

<h1>TLEdit&mdash;NXSYS Track Layout Editor </h1>

<p>&copy;Bernard S. Greenberg 1997&ndash;2022<br/>
Updated 17 February 2022</p>

<p>This is the documentation for TLEdit, the NXSYS track layout editor. It is used to create and edit layouts as seen on the interlocking panel. It does not create or edit logic in any way.</p>

<p>Layouts consist of straight line <b>track segments</b> which connect <b>joints</b>, which latter appear in TLEdit as red dots (but do not appear at all in NXSYS).  Tracks can only bend or join at joints. A joint can sport one, two, or three segments (“branches”) emanating from it &mdash; one is the end of a track, two is an insulated joint, or a “kink” in a track, and three is a switch.</p>

<h2>TLEdit three-line summary!</h2>
<ul style="font-size:135%">
<li>
   <b>MOUSE LEFT</b> (click and drag) <b>creates new trackage</b>, including switches.</li>
<li>   <b>MOUSE RIGHT</b> (click and drag)<b> creates, moves, and aligns joints</b> on Windows,</li>
<li>   <b>but CONTROL-MOUSE</b> instead of <b>mouse right</b> on the Mac.</li>
</ul>

<h2>Toolbar</h2>

<p>The TLEdit toolbar is central to all operations other than creating track.  While the Mac button images are large and clear, the Windows ones are ... less so.  Here is the Windows toolbar, with the labelling of each tool. Their meanings are explained below. They do have tooltips.</p>
<img src="tletoolb.png">
<table style="white-space:pre;margin-left:20px;">
  <tr>
    <td>1. <b>Exit</b> (back of a train)
2. <b>Open</b> (an extant layout file)
3. <b>Save</b>
4. <b>Show Joints</b> (nonselected ones, that is)
5. <b>Show Exit Lights</b>
6. <b>Cut</b>
7. <b>Properties dialog</b>
8. <b>Insulate joint</b>
9. <b>Flip switch or IJ number side</b>

</td>
<td>10. <b>Place Signal, northward or eastward</b>
11. <b>Place Signal, southward or westward</b>
12. <b>Create Exit Light</b> at signal
13. <b>Create Auxiliary Switch key</b>
14. <b>Create Traffic Lever knob</b>
15. <b>Create General Panel Light</b>
16. <b>Create General Panel Switch</b>
17. <b>Create text string</b>
  </td></tr></table>


<h2>Creating and editing track</h2>

<p>Click and drag mouse left (Windows, or Mac trackpad, single finger) to create a new track segment.  Click left on either an extant joint which is not already “full” (i.e., has less than  3 branches), some other point on an extant segment, or elsewhere, and drag the mouse, left button held.  You will be dragging the end of a &ldquo;rubber band&rdquo;, whose other end is where you started.  Drop the mouse on either an extant joint which is <b>not full</b>, some other point on an extant segment, or elsewhere &mdash; a new segment will be created.  To cancel, i.e., change your mind and create no new segment, drop the mouse end of the rubber band back on the stationary end.  Slopes of less than 4% from the vertical or horizontal are assumed to be vertical or horizontal, and “snapped” into place.</p>

<p>To <b>move an extant joint</b>, click and drag it with mouse right (on Windows; control-mouse on the Mac). Clicking and dragging mouse right in the middle of an extant segment creates a joint and moves it &mdash; you can insert a “kink” this way. If you drag a joint to another joint, and there are no more than three branches among the two of them, the joints will merge into one.  The rubber band lines will “click” onto a detente (and show as red) if TLEdit thinks it knows what you are trying to do.</p>

<p>Placing a new joint in the middle of an extant segment via either tool splits the segment in two at that point.  For mouse left, the new joint will not come into existence until you actually drag the mouse.  For mouse right, a new joint will come into existence immediately.</p>

<p>Any object (joint, segment, signal, exit light, or switch key) may be selected, which turns it green, by clicking left on it. A newly-created object, or a joint just moved, is automatically selected.  Pressing the <b>Edit Properties</b> tool (or typing <b>Ctrl+P</b>, both Windows and Mac) when an object is selected brings up its <b>properties dialog</b>, which is different for each type of object, allowing detailed control of its properties.  On the Mac, &ldquo;secondary gesture&rdquo; (right-click replacement) on any object calls up its properties dialog, too.</p>

<p><b>Cut</b> (use the <b>Cut</b> tool or <b>Ctrl-X</b>, <b>⌘X</b> in the Mac) to delete a selected object.  Loose ends of a deleted segment will vanish with it.  <b>Cut</b> of a selected joint of two branches will remove the joint and collapse the two segments into one, joining the endpoints of the previous two.  <b>You must delete all signals and exit lights at an insulated joint before the joint can be deleted</b>.  There is presently no undo or paste.</p>

<p>A joint of two branches can be made insulated by selecting it and clicking the <b>Insulate</b> tool (insulated joints appear as yellow dots.)  Creating a signal at an uninsulated joint of two branches it insulates the joint automatically.</p>

<p>Scroll down or to the right to extend layout those ways.  To extend up or to the left, use <b>View|Shift Layout</b> (<b>Alt+S</b> on Windows, no accelerator on Mac).  This takes much time to run.  To set the default view origin that comes up in NXSYS, scroll until you are looking at it, and use <b>View|Set Viewport here</b>.</p>

<p> The problem of how to establish an empty space of known dimensions, or &ldquo;large enough&rdquo; on the Mac is non-obvious, and discussed in the <a href="MacTleHelp.html">Mac-specific TLEdit help file.</a>.</p>

<h2>Creating and Editing Other Objects</h2>

<p><b>To create a signal</b>: Select any joint of 1 or 2 branches (i.e., not a switch), or make one with mouse right.  Choose the one of the two <b>Create signal</b> with the closer of the two orientations (If you guess wrong, cut it and try again).  Signals move around as you move the joint.  Click right on a signal calls up its <b>properties dialog</b>, which allows editing or assignment of lever numbers, lenses, absence of stop, etc.  <b>Station Number</b> is the decimal number that will be used to identify relays associated with the signal and from which the signal ID plate will be computed.  IRT and BMT/IND conventions for choosing this differ. Select and <b>Cut</b> to delete a signal.</p>

<p><b>To create an (entrance/)exit light:</b> Exit lights can be created by selecting a signal and clicking the <b>Create or Select Exit Light</b> tool to create an exit light for exiting at that signal.  Normally, exit lights, other than a selected one, including one just created, are hidden. To show all exit lights, toggle the <b>Show/Don't Show Exit Lights</b> tool; they can only be clicked for cutting or properties (lever number) editing when lit. To create a same-direction exit (when there is no signal in the entrance direction), create such a signal, create its exit light, and delete the signal.  Exit lights, when created, inherit the lever number, if any, of their signals.</p>

<p><b>Insulated joint station numbers</b> and <b>switch numbers</b> can be assigned via the joint&rsquo;s <b>properties dialog</b>.  All insulated joints and switch joints are automatically assigned unique numbers (to facilitate reload) over 10000, which do not display on the panel.  Set them as you want via the dialog.  You can “flip” IJ station numbers and switch numbers between sides of the track (to address visual collisions) with the <b>Flip Numbers</b> tool.</p>

<p><b>Auxiliary switch keys</b> are created by pressing the tool that resembles one: move the mouse to the final position, and click left to drop it there.  Type any character or click right to abort.  To edit a key&rsquo;s switch number or board position, click right on it or use the <b>properties dialog</b> tool.  To move one, select it first, release the mouse button, and then click and drag left to a new position.  Select it and <b>Cut</b> to destroy it.</p>

<p><b>Traffic levers</b> and <b>generic panel switches</b> and <b>lamps</b> are created with the three tools that resemble them.  Creation and property editing is identical to that for auxiliary switch keys (above).  Traffic lever graphics in-line with track is not supported yet; use arbitrary text to label to taste.  “Normal” direction (left or right &mdash; affects relay nomenclature and initial state) is set from the properties dialog.</p>

<p><b>Arbitrary text strings</b> of any size or font are created by pressing the tool labelled “abc”: move the mouse to the final position, click left to drop.  Dragging/moving, selection, destruction, and editing is the same as for auxiliary switch keys.  Click right or use the properties tool to set text content, font, size. etc.  Don&rsquo;t use private fonts not likely to be on someone else&rsquo;s machine.</p>


<h2>Assigning Track Circuit Identifiers</h2>

<p>Track segments assemble into track <b>sections</b> (<b>track circuits</b>); NXSYS generates and manages T relays and "line-o-lite"s on a per-circuit basis.  Select and <b>property edit</b> a track segment to assign a numeric track circuit relay ID.  If <b>Wildfire spread by contact</b> is selected, all track segments reachable from the one being edited without passing an insulated joint will have their Circuit ID's changed as well.  NXSYS will not equip a track segment with the default ID (0).  Track segments with circuits assigned light with white "line-o-lites" in TLEdit. The algorithm for managing segments dependent on switch position, within one circuit, is a complex heuristic built into NXSYS (which occasionally fails).  Individual segments are not &ldquo;programmable&rdquo; as they are in real life.

<h2>Switch Orientation (which route is “normal”?)</h2>

<p>TLEdit by default assigns the three branches emanating from a switch joint the designations <b>stem, normal,</b> and <b>reverse</b>, based upon the angles between them.  In some cases, notably for slip switches, this default is not correct.  The two buttons <b>highlight normal</b> and <b>swap normal</b> on the switch&rsquo;s <b>properties dialog</b> can be used to see which branch is “normal” (selecting it) and swap the definitions of normal and reverse (highlighting the new <b>normal</b>, as it were) to facilitate manual adjustment.
</p>

<p>========================================================================</p>

<p>Use <b>Ctrl-W</b> (or <b>New</b>) to “wipe” the drawing clear, on Windows, but <b>⌘N</b> (<b>New</b>) on the Mac.</p>

<p>Use the <b>Show joints</b> tool (an on/off button) to see what the panel will look like on NXSYS (i.e., no red dots).</p>

<p>You can save and restore your creations.  The app will accept a file name as a command argument.</p>

<p>You can <tt>(include "foo.trk")</tt> in an NXSYS <tt>.trk</tt> file.  The outer file should contain, or co-include, all the relay definitions and the TLEdit-generated file, which latter should not be hand-edited.  (The language is fairly obvious, and is left as an exercise for the user. You should not have to understand its details.)</p>
</body>
</html>
